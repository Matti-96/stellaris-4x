is_potential_vassal_after_war = {
	is_at_war_with = $OVERLORD$
	any_war = {
		OR = {
			using_war_goal = {
				type = wg_tribute
				owner = $OVERLORD$
			}
			using_war_goal = {
				type = wg_subjugation
				owner = $OVERLORD$
			}
			using_war_goal = {
				type = wg_megacorp_subjugate
				owner = $OVERLORD$
			}
			using_war_goal = {
				type = wg_bring_into_the_fold
				owner = $OVERLORD$
			}
			using_war_goal = {
				type = wg_bring_into_the_fold_corporate
				owner = $OVERLORD$
			}
		}
		NOT = {
			is_war_participant = {
				who = prev
				side = $OVERLORD$
			}
		}
		OR = {
			attacker = {
				OR = {
					is_same_value = prevprev
					has_subject = prevprev
				}
			}
			defender = {
				OR = {
					is_same_value = prevprev
					has_subject = prevprev
				}
			}
		}
	}
}

vassalization_with_from_is_within_rules = {
	custom_tooltip = { # Europe: added
		fail_text = requires_less_than_two_vassals
		exists = from
		OR = {
			is_ai = yes
			from = { is_ai = yes }
			if = {
				limit = {
					NOT = {
						any_country = {
							is_ai = no
							OR = {
								has_overlord = prev
								has_secret_fealty_with = prev
								is_potential_vassal_after_war = { OVERLORD = prev }
							}
						}
					}
				}
				from = {
					NOT = {
						count_country = {
							count = 2
							limit = {
								is_ai = no
								OR = {
									has_overlord = prev
									has_secret_fealty_with = prev
									is_potential_vassal_after_war = { OVERLORD = prev }
								}
							}
						}
					}
				}
			}
			else = {
				from = {
					NOT = {
						any_country = {
							is_ai = no
							OR = {
								has_overlord = prev
								has_secret_fealty_with = prev
								is_potential_vassal_after_war = { OVERLORD = prev }
							}
						}
					}
				}
				NOT = {
					count_country = {
						count = 2
						limit = {
							is_ai = no
							OR = {
								has_overlord = prev
								has_secret_fealty_with = prev
								is_potential_vassal_after_war = { OVERLORD = prev }
							}
						}
					}
				}
			}
		}
	}
}